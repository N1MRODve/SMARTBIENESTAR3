import{d as p,B as j,f as P,h as o,j as e,v as n,z as i,t as a,I as u,F as B,y as F,D as L,o as l,E as D,b as N}from"./vue-vendor-DLSXyIw7.js";import{u as V,s as b,F as f,B as z}from"./index-D33O_vwf.js";import{P as h}from"./plus-n9pYVzkT.js";import{S as T}from"./square-pen-Bab3IBLH.js";import{T as q}from"./trash-2-OdR_kCZk.js";import"./supabase-B7V2753y.js";const A={class:"space-y-6"},R={class:"bg-white border border-gray-200 rounded-lg shadow-sm p-6"},$={class:"flex items-center justify-between"},G={class:"flex items-center space-x-3"},I={class:"w-10 h-10 border border-gray-300 rounded-lg flex items-center justify-center"},M={class:"text-sm text-gray-600 mt-0.5"},H={key:0,class:"flex items-center justify-center py-20"},J={key:1,class:"bg-white border border-gray-200 rounded-lg shadow-sm p-12 text-center"},K={class:"w-16 h-16 mx-auto mb-4 border border-gray-300 rounded-lg flex items-center justify-center"},O={key:2,class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Q={class:"p-6"},U={class:"flex items-start justify-between mb-3"},W={class:"flex-1 pr-4"},X={class:"text-base font-semibold text-gray-900 mb-1"},Y={class:"text-sm text-gray-600 line-clamp-2"},Z={class:"flex items-center gap-3 text-xs text-gray-600 mb-4"},ee={class:"pt-4 border-t border-gray-100"},te={class:"grid grid-cols-2 gap-4 text-sm mb-4"},se={class:"font-medium text-gray-900 text-xs"},re={class:"font-medium text-gray-900 text-xs capitalize"},ae={class:"flex gap-2"},oe=["onClick"],ne=["onClick"],ie=["onClick"],ye={__name:"EncuestasView",setup(le){const m=L(),v=V(),d=p([]),g=p(!0),_=j(()=>d.value.length>0),w=r=>({"salud-mental":"Salud Mental","carga-laboral":"Carga Laboral",comunicacion:"Comunicación",ergonomia:"Ergonomía",desarrollo:"Desarrollo Profesional",general:"Bienestar General","clima-laboral":"Clima Laboral"})[r]||"General";P(async()=>{await x()});const x=async()=>{g.value=!0;try{const{data:r,error:t}=await b.from("encuestas").select("*, preguntas:preguntas_encuesta(count)").eq("empresa_id",v.empresaId).order("fecha_creacion",{ascending:!1});if(t)throw t;d.value=(r||[]).map(s=>{var c;return{...s,totalPreguntas:((c=s.preguntas[0])==null?void 0:c.count)||0}})}catch(r){console.error("Error cargando encuestas:",r)}finally{g.value=!1}},C=r=>{m.push({name:"admin-encuesta-resultados",params:{encuestaId:r}})},k=r=>{m.push({name:"admin-editar-encuesta",params:{encuestaId:r}})},y=()=>{m.push("/admin/encuestas/crear")},E=async r=>{if(confirm("¿Estás seguro de eliminar esta encuesta?"))try{const{error:t}=await b.from("encuestas").delete().eq("id",r);if(t)throw t;await x()}catch(t){console.error("Error eliminando encuesta:",t),alert("Error al eliminar la encuesta")}},S=r=>r?new Date(r).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"numeric"}):"-";return(r,t)=>(l(),o("div",A,[e("div",R,[e("div",$,[e("div",G,[e("div",I,[n(i(f),{class:"h-5 w-5 text-gray-900"})]),e("div",null,[t[0]||(t[0]=e("h1",{class:"text-xl font-semibold text-gray-900"},"Encuestas",-1)),e("p",M,a(d.value.length)+" registrada"+a(d.value.length!==1?"s":""),1)])]),e("button",{onClick:y,class:"inline-flex items-center px-4 py-2 bg-gray-900 text-white text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors"},[n(i(h),{class:"h-4 w-4 mr-2"}),t[1]||(t[1]=u(" Nueva Encuesta "))])])]),g.value?(l(),o("div",H,t[2]||(t[2]=[e("div",{class:"animate-spin rounded-full h-10 w-10 border-2 border-gray-300 border-t-gray-900"},null,-1)]))):_.value?(l(),o("div",O,[(l(!0),o(B,null,F(d.value,s=>(l(),o("div",{key:s.id,class:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-all overflow-hidden"},[e("div",Q,[e("div",U,[e("div",W,[e("h3",X,a(s.titulo),1),e("p",Y,a(s.descripcion||"Sin descripción"),1)]),e("span",{class:D(["px-2.5 py-1 text-xs font-medium rounded border whitespace-nowrap",{"bg-gray-50 text-gray-900 border-gray-900":s.estado==="Activa","bg-gray-50 text-gray-600 border-gray-300":s.estado==="borrador","bg-gray-50 text-gray-500 border-gray-200":s.estado==="Finalizada"}])},a(s.estado),3)]),e("div",Z,[e("span",null,a(w(s.categoria)),1),t[6]||(t[6]=e("span",{class:"w-1 h-1 bg-gray-300 rounded-full"},null,-1)),e("span",null,a(s.totalPreguntas)+" pregunta"+a(s.totalPreguntas!==1?"s":""),1)]),e("div",ee,[e("div",te,[e("div",null,[t[7]||(t[7]=e("span",{class:"text-gray-500 text-xs block mb-1"},"Creada",-1)),e("span",se,a(S(s.fecha_creacion)),1)]),e("div",null,[t[8]||(t[8]=e("span",{class:"text-gray-500 text-xs block mb-1"},"Privacidad",-1)),e("span",re,a(s.privacidad_nivel.replace("_"," ")),1)])]),e("div",ae,[s.estado==="Activa"?(l(),o("button",{key:0,onClick:c=>C(s.id),class:"flex-1 inline-flex items-center justify-center px-3 py-2 bg-gray-900 text-white text-xs font-medium rounded-lg hover:bg-gray-800 transition-colors"},[n(i(z),{class:"h-3.5 w-3.5 mr-1.5"}),t[9]||(t[9]=u(" Resultados "))],8,oe)):N("",!0),e("button",{onClick:c=>k(s.id),class:"flex-1 inline-flex items-center justify-center px-3 py-2 border border-gray-300 text-gray-900 text-xs font-medium rounded-lg hover:bg-gray-50 transition-colors"},[n(i(T),{class:"h-3.5 w-3.5 mr-1.5"}),t[10]||(t[10]=u(" Editar "))],8,ne),e("button",{onClick:c=>E(s.id),class:"inline-flex items-center justify-center px-3 py-2 border border-gray-300 text-gray-900 rounded-lg hover:bg-gray-50 transition-colors"},[n(i(q),{class:"h-3.5 w-3.5"})],8,ie)])])])]))),128))])):(l(),o("div",J,[e("div",K,[n(i(f),{class:"h-8 w-8 text-gray-400"})]),t[4]||(t[4]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"Sin encuestas",-1)),t[5]||(t[5]=e("p",{class:"text-gray-600 mb-6 max-w-md mx-auto"}," Crea tu primera encuesta para medir el clima laboral ",-1)),e("button",{onClick:y,class:"inline-flex items-center px-4 py-2 bg-gray-900 text-white text-sm font-medium rounded-lg hover:bg-gray-800 transition-colors"},[n(i(h),{class:"h-4 w-4 mr-2"}),t[3]||(t[3]=u(" Crear encuesta "))])]))]))}};export{ye as default};
