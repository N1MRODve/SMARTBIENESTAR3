import{x as P,D as L,O as k,Q as N,E as q,l as p,o as U,d as n,i as e,e as s,f as l,t as a,w as _,M as f,F as C,r as R,h as E,p as W,q as z,R as O,T as G,j as i,k as h,U as H,V as Q,W as X,X as Y,C as Z,L as J,Y as K,Z as ss}from"./index-BNX75qeA.js";import{_ as ts,A as es}from"./Header-DER_1DC1.js";import{A as as,R as os}from"./refresh-cw-Cn7AM7BE.js";/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=P("ChevronRightIcon",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=P("DownloadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),rs={class:"min-h-screen bg-gray-50"},ns={class:"py-8"},is={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},ds={key:0,class:"bg-white rounded-lg shadow-sm p-8 text-center"},cs={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6 text-center"},us={class:"text-red-600 mb-4"},ms={key:2,class:"space-y-8"},xs={class:"flex","aria-label":"Breadcrumb"},ps={class:"flex items-center space-x-4"},_s={class:"flex items-center"},fs={class:"flex items-center"},hs={class:"text-sm font-medium text-gray-900"},gs={class:"bg-white rounded-lg shadow-sm p-6"},vs={class:"flex justify-between items-start"},bs={class:"text-3xl font-bold text-gray-900 mb-2"},ys={class:"flex items-center space-x-6 text-sm text-gray-500"},ws={class:"flex items-center"},ks={class:"flex items-center"},Cs={class:"flex items-center"},Rs={class:"flex space-x-3"},Es={key:0,class:"space-y-8"},Bs={class:"bg-gray-50 px-6 py-4 border-b border-gray-200"},Ps={class:"text-lg font-semibold text-gray-900"},As={class:"p-6"},Ms={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},Ss={class:"bg-gray-50 rounded-lg p-6"},Ts={class:"relative h-64 w-full"},$s=["id"],Is={class:"space-y-6"},Vs={class:"p-4 bg-blue-50 border border-blue-200 rounded-lg"},js={class:"flex items-start"},Ds={class:"text-blue-800 font-medium"},Fs={key:0,class:"p-4 bg-orange-50 border border-orange-200 rounded-lg"},Ls={class:"flex items-start justify-between"},Ns={class:"flex-1"},qs={class:"flex items-start"},Us={class:"font-semibold text-orange-900 mb-1"},Ws={class:"text-orange-800 text-sm"},zs={key:1,class:"p-4 bg-green-50 border border-green-200 rounded-lg"},Os={class:"flex items-center"},Gs={class:"space-y-2"},Hs={class:"text-sm text-gray-700"},Qs={class:"flex items-center"},Xs={class:"text-sm font-medium text-gray-900 mr-2"},Ys={class:"text-xs text-gray-500"},Zs={class:"bg-white rounded-lg shadow-sm p-6"},Js={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Ks={class:"text-center p-4 bg-blue-50 rounded-lg"},st={class:"text-2xl font-bold text-blue-600"},tt={class:"text-center p-4 bg-green-50 rounded-lg"},et={class:"text-2xl font-bold text-green-600"},at={class:"text-center p-4 bg-purple-50 rounded-lg"},ot={class:"text-2xl font-bold text-purple-600"},lt={__name:"ResultadosEncuestaView",setup(rt){k.register(...N);const A=W(),g=z(),M=q(),o=p(null),v=p(!0),m=p(null),b=p({}),w=async()=>{v.value=!0,m.value=null;try{const d=A.params.encuestaId,t=await O(d);o.value=t,await G(),S()}catch(d){m.value=d.message||"Error al cargar los resultados",console.error("Error cargando resultados:",d)}finally{v.value=!1}},S=()=>{var d;(d=o.value)!=null&&d.preguntas&&o.value.preguntas.forEach(t=>{t.resultados&&setTimeout(()=>{const u=document.getElementById(`chart-${t.id}`);if(u){b.value[t.id]&&b.value[t.id].destroy();const r=u.getContext("2d"),y=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"];b.value[t.id]=new k(r,{type:"doughnut",data:{labels:t.resultados.labels,datasets:[{data:t.resultados.data,backgroundColor:y.slice(0,t.resultados.labels.length),borderColor:"#ffffff",borderWidth:3,hoverOffset:8}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,pointStyle:"circle",font:{size:13,weight:"500"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#ffffff",borderWidth:1,callbacks:{label:function(c){const x=c.dataset.data.reduce((D,F)=>D+F,0),j=Math.round(c.parsed/x*100);return`${c.label}: ${c.parsed} respuestas (${j}%)`}}}},cutout:"65%",animation:{animateRotate:!0,duration:1e3}}})}},100)})},T=()=>{g.push("/admin/encuestas")},$=d=>{g.push({name:"admin-servicio-detalle",params:{id:d}})},I=()=>{M.add({severity:"info",summary:"Exportando resultados",detail:"Los resultados se están preparando para descarga...",life:4e3})},V=()=>{g.push("/admin/crear-comunicado")};return U(()=>{w()}),(d,t)=>{var u;return i(),n("div",rs,[e(ts,{subtitulo:"Resultados de Encuesta"}),s("div",ns,[s("div",is,[v.value?(i(),n("div",ds,t[0]||(t[0]=[s("div",{class:"animate-spin rounded-full h-12 w-12 border-2 border-primary border-t-transparent mx-auto mb-4"},null,-1),s("p",{class:"text-gray-600"},"Cargando resultados de la encuesta...",-1)]))):m.value?(i(),n("div",cs,[e(l(as),{class:"h-12 w-12 text-red-500 mx-auto mb-4"}),t[2]||(t[2]=s("h3",{class:"text-lg font-medium text-red-800 mb-2"},"Error al cargar los resultados",-1)),s("p",us,a(m.value),1),e(f,{onClick:w,variant:"outline"},{default:_(()=>[e(l(os),{class:"h-4 w-4 mr-2"}),t[1]||(t[1]=h(" Reintentar "))]),_:1,__:[1]})])):o.value?(i(),n("div",ms,[s("nav",xs,[s("ol",ps,[s("li",null,[s("button",{onClick:T,class:"text-gray-500 hover:text-gray-700 transition-colors duration-200"},[e(l(es),{class:"h-5 w-5"})])]),s("li",null,[s("div",_s,[e(l(B),{class:"h-5 w-5 text-gray-400 mr-4"}),t[3]||(t[3]=s("span",{class:"text-sm font-medium text-gray-500"},"Encuestas",-1))])]),s("li",null,[s("div",fs,[e(l(B),{class:"h-5 w-5 text-gray-400 mr-4"}),s("span",hs,a(o.value.titulo),1)])])])]),s("div",gs,[s("div",vs,[s("div",null,[s("h1",bs,a(o.value.titulo),1),s("div",ys,[s("div",ws,[e(l(H),{class:"h-4 w-4 mr-1"}),s("span",null,a(o.value.totalParticipantes)+" participantes",1)]),s("div",ks,[e(l(Q),{class:"h-4 w-4 mr-1"}),s("span",null,a(Math.round(o.value.totalParticipantes/50*100))+"% tasa de participación",1)]),s("div",Cs,[e(l(X),{class:"h-4 w-4 mr-1"}),s("span",null,a(o.value.estado),1)])])]),s("div",Rs,[e(f,{onClick:I,variant:"outline"},{default:_(()=>[e(l(ls),{class:"h-4 w-4 mr-2"}),t[4]||(t[4]=h(" Exportar "))]),_:1,__:[4]}),e(f,{onClick:V,variant:"primary"},{default:_(()=>[e(l(Y),{class:"h-4 w-4 mr-2"}),t[5]||(t[5]=h(" Crear Comunicado "))]),_:1,__:[5]})])])]),o.value.preguntas?(i(),n("div",Es,[(i(!0),n(C,null,R(o.value.preguntas,(r,y)=>(i(),n("div",{key:r.id,class:"bg-white rounded-lg shadow-sm overflow-hidden"},[s("div",Bs,[s("h3",Ps," Pregunta "+a(y+1)+": "+a(r.texto),1)]),s("div",As,[s("div",Ms,[s("div",null,[t[6]||(t[6]=s("h4",{class:"text-md font-medium text-gray-900 mb-4"},"Distribución de Respuestas",-1)),s("div",Ss,[s("div",Ts,[s("canvas",{id:`chart-${r.id}`,class:"w-full h-full"},null,8,$s)])])]),s("div",Is,[s("div",null,[t[7]||(t[7]=s("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Análisis del Resultado",-1)),s("div",Vs,[s("div",js,[e(l(Z),{class:"h-5 w-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0"}),s("p",Ds,a(r.insight),1)])])]),s("div",null,[t[10]||(t[10]=s("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Acción Recomendada",-1)),r.recomendacion?(i(),n("div",Fs,[s("div",Ls,[s("div",Ns,[s("div",qs,[e(l(J),{class:"h-5 w-5 text-orange-600 mt-0.5 mr-3 flex-shrink-0"}),s("div",null,[s("h5",Us,a(r.recomendacion.titulo),1),s("p",Ws,a(r.recomendacion.descripcion),1)])])]),e(f,{onClick:c=>$(r.recomendacion.id),class:"ml-4 flex-shrink-0"},{default:_(()=>[e(l(K),{class:"h-4 w-4 mr-2"}),t[8]||(t[8]=h(" Solicitar Servicio "))]),_:2,__:[8]},1032,["onClick"])])])):(i(),n("div",zs,[s("div",Os,[e(l(ss),{class:"h-5 w-5 text-green-600 mr-3"}),t[9]||(t[9]=s("p",{class:"text-green-800 font-medium"},"¡Excelente! No se requiere acción inmediata para esta área.",-1))])]))]),s("div",null,[t[11]||(t[11]=s("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Estadísticas Detalladas",-1)),s("div",Gs,[(i(!0),n(C,null,R(r.resultados.data,(c,x)=>(i(),n("div",{key:x,class:"flex items-center justify-between p-2 bg-gray-50 rounded"},[s("span",Hs,a(r.resultados.labels[x]),1),s("div",Qs,[s("span",Xs,a(c)+" respuestas",1),s("span",Ys," ("+a(Math.round(c/o.value.totalParticipantes*100))+"%) ",1)])]))),128))])])])])])]))),128))])):E("",!0),s("div",Zs,[t[15]||(t[15]=s("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Resumen Ejecutivo",-1)),s("div",Js,[s("div",Ks,[s("p",st,a(o.value.totalParticipantes),1),t[12]||(t[12]=s("p",{class:"text-sm text-blue-800"},"Total Participantes",-1))]),s("div",tt,[s("p",et,a(Math.round(o.value.totalParticipantes/50*100))+"%",1),t[13]||(t[13]=s("p",{class:"text-sm text-green-800"},"Tasa de Participación",-1))]),s("div",at,[s("p",ot,a(((u=o.value.preguntas)==null?void 0:u.length)||0),1),t[14]||(t[14]=s("p",{class:"text-sm text-purple-800"},"Preguntas Analizadas",-1))])])])])):E("",!0)])])])}}},ct=L(lt,[["__scopeId","data-v-2efccb82"]]);export{ct as default};
